{"version":3,"sources":["webpack:///./node_modules/@theia/core/src/electron-common/electron-token.ts","webpack:///./node_modules/@theia/plugin-ext/src/main/browser/webview/webview-widget-factory.ts","webpack:///./node_modules/@theia/plugin-ext/src/main/electron-browser/plugin-ext-frontend-electron-module.ts","webpack:///./node_modules/@theia/plugin-ext/src/main/electron-browser/webview/electron-webview-widget-factory.ts","webpack:///./node_modules/@theia/plugin-ext/src/plugin-ext-frontend-electron-module.ts"],"names":[],"mappings":"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","file":"74.bundle.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2020 Ericsson and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\n/**\n * This token is unique the the current running instance. It is used by the backend\n * to make sure it is an electron browser window that is connecting to its services.\n *\n * The identifier is a string, which makes it usable as a key for cookies or similar.\n */\nexport const ElectronSecurityToken = 'x-theia-electron-token';\nexport interface ElectronSecurityToken {\n    value: string;\n};\n","/********************************************************************************\n * Copyright (C) 2020 Ericsson and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { interfaces } from 'inversify';\nimport { WebviewWidget, WebviewWidgetIdentifier, WebviewWidgetExternalEndpoint } from './webview';\nimport { WebviewEnvironment } from './webview-environment';\n\nexport class WebviewWidgetFactory {\n\n    readonly id = WebviewWidget.FACTORY_ID;\n\n    protected readonly container: interfaces.Container;\n\n    constructor(container: interfaces.Container) {\n        this.container = container;\n    }\n\n    async createWidget(identifier: WebviewWidgetIdentifier): Promise<WebviewWidget> {\n        const externalEndpoint = await this.container.get(WebviewEnvironment).externalEndpoint();\n        let endpoint = externalEndpoint.replace('{{uuid}}', identifier.id);\n        if (endpoint[endpoint.length - 1] === '/') {\n            endpoint = endpoint.slice(0, endpoint.length - 1);\n        }\n        const child = this.container.createChild();\n        child.bind(WebviewWidgetIdentifier).toConstantValue(identifier);\n        child.bind(WebviewWidgetExternalEndpoint).toConstantValue(endpoint);\n        return child.get(WebviewWidget);\n    }\n\n}\n","/********************************************************************************\n * Copyright (C) 2020 Ericsson and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from 'inversify';\nimport { WebviewWidgetFactory } from '../browser/webview/webview-widget-factory';\nimport { ElectronWebviewWidgetFactory } from './webview/electron-webview-widget-factory';\n\nexport default new ContainerModule((bind, unbind, isBound, rebind) => {\n    rebind(WebviewWidgetFactory).toDynamicValue(ctx => new ElectronWebviewWidgetFactory(ctx.container)).inSingletonScope();\n});\n","/********************************************************************************\n * Copyright (C) 2020 Ericsson and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { remote } from 'electron';\nimport { ElectronSecurityToken } from '@theia/core/lib/electron-common/electron-token';\nimport { WebviewWidgetFactory } from '../../browser/webview/webview-widget-factory';\nimport { WebviewWidgetIdentifier, WebviewWidget } from '../../browser/webview/webview';\n\nexport class ElectronWebviewWidgetFactory extends WebviewWidgetFactory {\n\n    async createWidget(identifier: WebviewWidgetIdentifier): Promise<WebviewWidget> {\n        const widget = await super.createWidget(identifier);\n        await this.attachElectronSecurityCookie(widget.externalEndpoint);\n        return widget;\n    }\n\n    /**\n     * Attach the ElectronSecurityToken to a cookie that will be sent with each webview request.\n     *\n     * @param endpoint cookie's target url\n     */\n    protected async attachElectronSecurityCookie(endpoint: string): Promise<void> {\n        await remote.session.defaultSession!.cookies.set({\n            url: endpoint,\n            name: ElectronSecurityToken,\n            value: JSON.stringify(this.container.get(ElectronSecurityToken)),\n            httpOnly: true\n        });\n    }\n\n}\n","/********************************************************************************\n * Copyright (C) 2020 Ericsson and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport mainModule from './main/electron-browser/plugin-ext-frontend-electron-module';\n\nexport default mainModule;\n"],"sourceRoot":""}