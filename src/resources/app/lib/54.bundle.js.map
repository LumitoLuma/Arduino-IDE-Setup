{"version":3,"sources":["webpack:///./node_modules/@theia/search-in-workspace/src/browser/search-in-workspace-frontend-contribution.ts"],"names":[],"mappings":"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","file":"54.bundle.js","sourcesContent":["/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { AbstractViewContribution, KeybindingRegistry, LabelProvider, CommonMenus, FrontendApplication, FrontendApplicationContribution } from '@theia/core/lib/browser';\nimport { SearchInWorkspaceWidget } from './search-in-workspace-widget';\nimport { injectable, inject, postConstruct } from 'inversify';\nimport { CommandRegistry, MenuModelRegistry, SelectionService, Command } from '@theia/core';\nimport { Widget } from '@theia/core/lib/browser/widgets';\nimport { NavigatorContextMenu } from '@theia/navigator/lib/browser/navigator-contribution';\nimport { UriCommandHandler, UriAwareCommandHandler } from '@theia/core/lib/common/uri-command-handler';\nimport URI from '@theia/core/lib/common/uri';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport { FileSystem } from '@theia/filesystem/lib/common';\nimport { SearchInWorkspaceContextKeyService } from './search-in-workspace-context-key-service';\nimport { TabBarToolbarContribution, TabBarToolbarRegistry } from '@theia/core/lib/browser/shell/tab-bar-toolbar';\nimport { EditorManager } from '@theia/editor/lib/browser/editor-manager';\nimport { Range } from 'vscode-languageserver-types';\n\nexport namespace SearchInWorkspaceCommands {\n    const SEARCH_CATEGORY = 'Search';\n    export const TOGGLE_SIW_WIDGET = {\n        id: 'search-in-workspace.toggle'\n    };\n    export const OPEN_SIW_WIDGET: Command = {\n        id: 'search-in-workspace.open',\n        category: SEARCH_CATEGORY,\n        label: 'Find in Files'\n\n    };\n    export const FIND_IN_FOLDER: Command = {\n        id: 'search-in-workspace.in-folder',\n        category: SEARCH_CATEGORY,\n        label: 'Find in Folder'\n    };\n    export const REFRESH_RESULTS: Command = {\n        id: 'search-in-workspace.refresh',\n        category: SEARCH_CATEGORY,\n        label: 'Refresh',\n        iconClass: 'refresh'\n    };\n    export const CANCEL_SEARCH: Command = {\n        id: 'search-in-workspace.cancel',\n        category: SEARCH_CATEGORY,\n        label: 'Cancel Search',\n        iconClass: 'cancel'\n    };\n    export const COLLAPSE_ALL: Command = {\n        id: 'search-in-workspace.collapse-all',\n        category: SEARCH_CATEGORY,\n        label: 'Collapse All',\n        iconClass: 'theia-collapse-all-icon'\n    };\n    export const CLEAR_ALL: Command = {\n        id: 'search-in-workspace.clear-all',\n        category: SEARCH_CATEGORY,\n        label: 'Clear Search Results',\n        iconClass: 'clear-all'\n    };\n}\n\n@injectable()\nexport class SearchInWorkspaceFrontendContribution extends AbstractViewContribution<SearchInWorkspaceWidget> implements FrontendApplicationContribution, TabBarToolbarContribution {\n\n    @inject(SelectionService) protected readonly selectionService: SelectionService;\n    @inject(LabelProvider) protected readonly labelProvider: LabelProvider;\n    @inject(WorkspaceService) protected readonly workspaceService: WorkspaceService;\n    @inject(FileSystem) protected readonly fileSystem: FileSystem;\n    @inject(EditorManager) protected readonly editorManager: EditorManager;\n\n    @inject(SearchInWorkspaceContextKeyService)\n    protected readonly contextKeyService: SearchInWorkspaceContextKeyService;\n\n    constructor() {\n        super({\n            widgetId: SearchInWorkspaceWidget.ID,\n            widgetName: SearchInWorkspaceWidget.LABEL,\n            defaultWidgetOptions: {\n                area: 'left',\n                rank: 200\n            },\n            toggleCommandId: SearchInWorkspaceCommands.TOGGLE_SIW_WIDGET.id\n        });\n    }\n\n    @postConstruct()\n    protected init(): void {\n        const updateFocusContextKey = () =>\n            this.contextKeyService.searchViewletFocus.set(this.shell.activeWidget instanceof SearchInWorkspaceWidget);\n        updateFocusContextKey();\n        this.shell.activeChanged.connect(updateFocusContextKey);\n    }\n\n    async initializeLayout(app: FrontendApplication): Promise<void> {\n        await this.openView({ activate: false });\n    }\n\n    async registerCommands(commands: CommandRegistry): Promise<void> {\n        super.registerCommands(commands);\n        commands.registerCommand(SearchInWorkspaceCommands.OPEN_SIW_WIDGET, {\n            isEnabled: () => this.workspaceService.tryGetRoots().length > 0,\n            execute: async () => {\n                const widget = await this.openView({ activate: true });\n                widget.updateSearchTerm(this.getSearchTerm());\n            }\n        });\n\n        commands.registerCommand(SearchInWorkspaceCommands.FIND_IN_FOLDER, this.newMultiUriAwareCommandHandler({\n            execute: async uris => {\n                const resources: string[] = [];\n                await Promise.all(uris.map(uri =>\n                    this.fileSystem.getFileStat(uri.toString())\n                )).then(stats => {\n                    for (const stat of stats) {\n                        if (stat) {\n                            const uri = new URI(stat.uri);\n                            let uriStr = this.labelProvider.getLongName(uri);\n                            if (stat && !stat.isDirectory) {\n                                uriStr = this.labelProvider.getLongName(uri.parent);\n                            }\n                            resources.push(uriStr);\n                        }\n                    }\n                });\n                const widget = await this.openView({ activate: true });\n                widget.findInFolder(resources);\n            }\n        }));\n\n        commands.registerCommand(SearchInWorkspaceCommands.CANCEL_SEARCH, {\n            execute: w => this.withWidget(w, widget => widget.getCancelIndicator() && widget.getCancelIndicator()!.cancel()),\n            isEnabled: w => this.withWidget(w, widget => widget.getCancelIndicator() !== undefined),\n            isVisible: w => this.withWidget(w, widget => widget.getCancelIndicator() !== undefined)\n        });\n        commands.registerCommand(SearchInWorkspaceCommands.REFRESH_RESULTS, {\n            execute: w => this.withWidget(w, widget => widget.refresh()),\n            isEnabled: w => this.withWidget(w, widget => (widget.hasResultList() || widget.hasSearchTerm()) && this.workspaceService.tryGetRoots().length > 0),\n            isVisible: w => this.withWidget(w, () => true)\n        });\n        commands.registerCommand(SearchInWorkspaceCommands.COLLAPSE_ALL, {\n            execute: w => this.withWidget(w, widget => widget.collapseAll()),\n            isEnabled: w => this.withWidget(w, widget => widget.hasResultList()),\n            isVisible: w => this.withWidget(w, () => true)\n        });\n        commands.registerCommand(SearchInWorkspaceCommands.CLEAR_ALL, {\n            execute: w => this.withWidget(w, widget => widget.clear()),\n            isEnabled: w => this.withWidget(w, widget => widget.hasResultList()),\n            isVisible: w => this.withWidget(w, () => true)\n        });\n    }\n\n    protected withWidget<T>(widget: Widget | undefined = this.tryGetWidget(), fn: (widget: SearchInWorkspaceWidget) => T): T | false {\n        if (widget instanceof SearchInWorkspaceWidget && widget.id === SearchInWorkspaceWidget.ID) {\n            return fn(widget);\n        }\n        return false;\n    }\n\n    /**\n     * Get the search term based on current editor selection.\n     * @returns the selection if available.\n     */\n    protected getSearchTerm(): string {\n        if (!this.editorManager.currentEditor) {\n            return '';\n        }\n        // Get the current editor selection.\n        const selection = this.editorManager.currentEditor.editor.selection;\n        // Compute the selection range.\n        const selectedRange: Range = Range.create(\n            selection.start.line,\n            selection.start.character,\n            selection.end.line,\n            selection.end.character\n        );\n        // Return the selection text if available, else return empty.\n        return this.editorManager.currentEditor\n            ? this.editorManager.currentEditor.editor.document.getText(selectedRange)\n            : '';\n    }\n\n    registerKeybindings(keybindings: KeybindingRegistry): void {\n        super.registerKeybindings(keybindings);\n        keybindings.registerKeybinding({\n            command: SearchInWorkspaceCommands.OPEN_SIW_WIDGET.id,\n            keybinding: 'ctrlcmd+shift+f'\n        });\n    }\n\n    registerMenus(menus: MenuModelRegistry): void {\n        super.registerMenus(menus);\n        menus.registerMenuAction(NavigatorContextMenu.SEARCH, {\n            commandId: SearchInWorkspaceCommands.FIND_IN_FOLDER.id\n        });\n        menus.registerMenuAction(CommonMenus.EDIT_FIND, {\n            commandId: SearchInWorkspaceCommands.OPEN_SIW_WIDGET.id\n        });\n    }\n\n    async registerToolbarItems(toolbarRegistry: TabBarToolbarRegistry): Promise<void> {\n        const widget = await this.widget;\n        const onDidChange = widget.onDidUpdate;\n        toolbarRegistry.registerItem({\n            id: SearchInWorkspaceCommands.CANCEL_SEARCH.id,\n            command: SearchInWorkspaceCommands.CANCEL_SEARCH.id,\n            tooltip: SearchInWorkspaceCommands.CANCEL_SEARCH.label,\n            priority: 0,\n            onDidChange\n        });\n        toolbarRegistry.registerItem({\n            id: SearchInWorkspaceCommands.REFRESH_RESULTS.id,\n            command: SearchInWorkspaceCommands.REFRESH_RESULTS.id,\n            tooltip: SearchInWorkspaceCommands.REFRESH_RESULTS.label,\n            priority: 1,\n            onDidChange\n        });\n        toolbarRegistry.registerItem({\n            id: SearchInWorkspaceCommands.CLEAR_ALL.id,\n            command: SearchInWorkspaceCommands.CLEAR_ALL.id,\n            tooltip: SearchInWorkspaceCommands.CLEAR_ALL.label,\n            priority: 2,\n            onDidChange\n        });\n        toolbarRegistry.registerItem({\n            id: SearchInWorkspaceCommands.COLLAPSE_ALL.id,\n            command: SearchInWorkspaceCommands.COLLAPSE_ALL.id,\n            tooltip: SearchInWorkspaceCommands.COLLAPSE_ALL.label,\n            priority: 3,\n            onDidChange\n        });\n    }\n\n    protected newUriAwareCommandHandler(handler: UriCommandHandler<URI>): UriAwareCommandHandler<URI> {\n        return new UriAwareCommandHandler(this.selectionService, handler);\n    }\n\n    protected newMultiUriAwareCommandHandler(handler: UriCommandHandler<URI[]>): UriAwareCommandHandler<URI[]> {\n        return new UriAwareCommandHandler(this.selectionService, handler, { multi: true });\n    }\n}\n"],"sourceRoot":""}